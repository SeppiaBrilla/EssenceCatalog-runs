language ESSENCE' 1.0

given Tasks_EnumSize: int
given fin1: int
given fin2: int
given shifts_ExplicitR6_ExplicitVarSizeWithDummy:
        matrix indexed by [int(1..fin1), int(1..fin2)] of int(1..Tasks_EnumSize + 1)
find sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Marker: int(0..Tasks_EnumSize)
find sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Marker:
        matrix indexed by [int(1..Tasks_EnumSize)] of int(0..Tasks_EnumSize)
find sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Values:
        matrix indexed by [int(1..Tasks_EnumSize), int(1..Tasks_EnumSize)] of int(1..Tasks_EnumSize)
branching on
    [sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Marker,
     sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Marker,
     sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Values]
minimising sum([toInt(q32 <= sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Marker) | q32 : int(1..Tasks_EnumSize)])
such that
    and([q16 <= sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Marker ->
         or([and([or([q22 <=
                      sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Marker[q16]
                      /\
                      sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Values[q16, q22]
                      = shifts_ExplicitR6_ExplicitVarSizeWithDummy[q18, q20]
                          | q22 : int(1..Tasks_EnumSize)])
                      | q20 : int(1..fin2), shifts_ExplicitR6_ExplicitVarSizeWithDummy[q18, q20] != Tasks_EnumSize + 1])
             /\
             and([q24 <= sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Marker[q16]
                  ->
                  or([shifts_ExplicitR6_ExplicitVarSizeWithDummy[q18, q26] =
                      sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Values[q16, q24]
                          | q26 : int(1..fin2),
                            shifts_ExplicitR6_ExplicitVarSizeWithDummy[q18, q26] != Tasks_EnumSize + 1])
                      | q24 : int(1..Tasks_EnumSize)])
                 | q18 : int(1..fin1)])
             | q16 : int(1..Tasks_EnumSize)]),
    alldifferent_except([toInt(q27 <= sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Marker /\
                               q28 <=
                               sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Marker
                                   [q27])
                         *
                         catchUndef(sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Values
                                        [q27, q28],
                                    0)
                             | q27 : int(1..Tasks_EnumSize), q28 : int(1..Tasks_EnumSize)],
                        0),
    and([q29 <= sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Marker ->
         sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Marker[q29] >= 1
             | q29 : int(1..Tasks_EnumSize)]),
    and([q4 + 1 <= sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Marker ->
         flatten([[sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Marker[q4];
                       int(1)],
                  [sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Values[q4, q11]
                       | q11 : int(1..Tasks_EnumSize)];
                      int(1..2)])
         <lex
         flatten([[sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Marker[q4 + 1];
                       int(1)],
                  [sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Values[q4 + 1, q12]
                       | q12 : int(1..Tasks_EnumSize)];
                      int(1..2)])
             | q4 : int(1..Tasks_EnumSize - 1)]),
    and([q5 > sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Marker ->
         sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Marker[q5] = 0 /\
         and([sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Values[q5, q13] = 1
                  | q13 : int(1..Tasks_EnumSize)])
             | q5 : int(1..Tasks_EnumSize)]),
    sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Marker <= Tasks_EnumSize,
    and([q6 <= sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Marker ->
         and([q7 + 1 <= sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Marker[q6] ->
              sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Values[q6, q7] <
              sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Values[q6, q7 + 1]
                  | q7 : int(1..Tasks_EnumSize - 1)])
             | q6 : int(1..Tasks_EnumSize)]),
    and([q6 <= sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Marker ->
         and([q8 > sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Marker[q6] ->
              sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Values[q6, q8] = 1
                  | q8 : int(1..Tasks_EnumSize)])
             | q6 : int(1..Tasks_EnumSize)]),
    and([q6 <= sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Marker ->
         sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Marker[q6] <= Tasks_EnumSize
             | q6 : int(1..Tasks_EnumSize)]),
    Tasks_EnumSize =
    sum([toInt(q14 <= sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Marker) *
         catchUndef(sched_PartitionAsSet_ExplicitVarSizeWithMarkerR5_Values_ExplicitVarSizeWithMarker_Marker[q14], 0)
             | q14 : int(1..Tasks_EnumSize)])

$ Conjure's
$ {"finds": [{"Name": "sched"}], "givens": [{"Name": "shifts"}], "enumGivens": [{"Name": "Tasks"}], "enumLettings": [],
$  "lettings":
$      [[{"Name": "Tasks"},
$        {"Domain":
$             {"DomainInt":
$                  [{"TagEnum": "Tasks"},
$                   [{"RangeBounded":
$                         [{"Constant": {"ConstantInt": [{"TagEnum": "Tasks"}, 1]}},
$                          {"Reference":
$                               [{"Name": "Tasks_EnumSize"},
$                                {"DeclNoRepr":
$                                     ["Given", {"Name": "Tasks_EnumSize"}, {"DomainInt": [{"TagEnum": "Tasks"}, []]},
$                                      {"NoRegion": []}]}]}]}]]}}]],
$  "unnameds": [], "strategyQ": {"PickFirst": []}, "strategyA": {"PickAll": []},
$  "trailCompact":
$      [[1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 3, 4], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1], [1, 1, 1]],
$  "trailVerbose": [], "trailRewrites": [], "nameGenState": [["fin", 3], ["q", 33]], "nbExtraGivens": 2,
$  "representations":
$      [[{"MachineName": ["fin", 1, []]}, {"DomainInt": [{"TagInt": []}, []]}],
$       [{"MachineName": ["fin", 2, []]}, {"DomainInt": [{"TagInt": []}, []]}],
$       [{"Name": "Tasks_EnumSize"}, {"DomainInt": [{"TagEnum": "Tasks"}, []]}],
$       [{"Name": "sched"},
$        {"DomainPartition":
$             [{"Partition_AsSet": [{"Set_ExplicitVarSizeWithMarker": []}, {"Set_ExplicitVarSizeWithMarker": []}]},
$              {"isRegular": false,
$               "partsNum":
$                   {"SizeAttr_MaxSize":
$                        {"Reference":
$                             [{"Name": "Tasks_EnumSize"},
$                              {"DeclHasRepr":
$                                   ["Given", {"Name": "Tasks_EnumSize"}, {"DomainInt": [{"TagEnum": "Tasks"}, []]}]}]}},
$               "partsSize":
$                   {"SizeAttr_MaxSize":
$                        {"Reference":
$                             [{"Name": "Tasks_EnumSize"},
$                              {"DeclHasRepr":
$                                   ["Given", {"Name": "Tasks_EnumSize"}, {"DomainInt": [{"TagEnum": "Tasks"}, []]}]}]}}},
$              {"DomainInt":
$                   [{"TagEnum": "Tasks"},
$                    [{"RangeBounded":
$                          [{"Constant": {"ConstantInt": [{"TagEnum": "Tasks"}, 1]}},
$                           {"Reference":
$                                [{"Name": "Tasks_EnumSize"},
$                                 {"DeclHasRepr":
$                                      ["Given", {"Name": "Tasks_EnumSize"},
$                                       {"DomainInt": [{"TagEnum": "Tasks"}, []]}]}]}]}]]}]}],
$       [{"Name": "shifts"},
$        {"DomainSet":
$             [{"Set_Explicit": []},
$              {"SizeAttr_Size":
$                   {"Reference":
$                        [{"MachineName": ["fin", 1, []]},
$                         {"DeclHasRepr":
$                              ["Given", {"MachineName": ["fin", 1, []]}, {"DomainInt": [{"TagInt": []}, []]}]}]}},
$              {"DomainSet":
$                   [{"Set_ExplicitVarSizeWithDummy": []},
$                    {"SizeAttr_MaxSize":
$                         {"Reference":
$                              [{"MachineName": ["fin", 2, []]},
$                               {"DeclHasRepr":
$                                    ["Given", {"MachineName": ["fin", 2, []]}, {"DomainInt": [{"TagInt": []}, []]}]}]}},
$                    {"DomainInt":
$                         [{"TagEnum": "Tasks"},
$                          [{"RangeBounded":
$                                [{"Constant": {"ConstantInt": [{"TagEnum": "Tasks"}, 1]}},
$                                 {"Reference":
$                                      [{"Name": "Tasks_EnumSize"},
$                                       {"DeclHasRepr":
$                                            ["Given", {"Name": "Tasks_EnumSize"},
$                                             {"DomainInt": [{"TagEnum": "Tasks"}, []]}]}]}]}]]}]}]}]],
$  "representationsTree":
$      [[{"Name": "Tasks_EnumSize"}, [{"rootLabel": null, "subForest": []}]],
$       [{"MachineName": ["fin", 1, []]}, [{"rootLabel": null, "subForest": []}]],
$       [{"MachineName": ["fin", 2, []]}, [{"rootLabel": null, "subForest": []}]],
$       [{"Name": "sched"},
$        [{"rootLabel":
$              {"Partition_AsSet": [{"Set_ExplicitVarSizeWithMarker": []}, {"Set_ExplicitVarSizeWithMarker": []}]},
$          "subForest": [{"rootLabel": null, "subForest": []}]}]],
$       [{"Name": "shifts"},
$        [{"rootLabel": {"Set_Explicit": []},
$          "subForest":
$              [{"rootLabel": {"Set_ExplicitVarSizeWithDummy": []},
$                "subForest": [{"rootLabel": null, "subForest": []}]}]}]]],
$  "originalDomains":
$      [[{"Name": "shifts"},
$        {"DomainSet":
$             [[], {"SizeAttr_None": []},
$              {"DomainSet": [[], {"SizeAttr_None": []}, {"DomainEnum": [{"Name": "Tasks"}, null, null]}]}]}],
$       [{"Name": "sched"},
$        {"DomainPartition":
$             [[],
$              {"isRegular": false,
$               "partsNum":
$                   {"SizeAttr_MaxSize":
$                        {"Reference":
$                             [{"Name": "Tasks_EnumSize"},
$                              {"DeclHasRepr":
$                                   ["Given", {"Name": "Tasks_EnumSize"}, {"DomainInt": [{"TagInt": []}, []]}]}]}},
$               "partsSize":
$                   {"SizeAttr_MaxSize":
$                        {"Reference":
$                             [{"Name": "Tasks_EnumSize"},
$                              {"DeclHasRepr":
$                                   ["Given", {"Name": "Tasks_EnumSize"}, {"DomainInt": [{"TagInt": []}, []]}]}]}}},
$              {"DomainEnum": [{"Name": "Tasks"}, null, null]}]}]],
$  "trailGeneralised":
$      [[1549034803569557140, -8241984151910398826], [8497379181974975746, 1255488532644803572],
$       [8003909354969724009, 3548004374953539189], [-321697868261234321, 6488542860665486152],
$       [-2983615627085717242, 2627208495169894603], [1528504679248749918, -8112450597396923468],
$       [5987771150815343600, -4008414391411561310], [-7907107981155023002, -5126647861049982533],
$       [-2465422821534529964, -6439234863871313254], [5698515260561673616, -462127286014871327],
$       [-7534591559923890805, -8555187307906166714], [1621707356553920073, 2942622328083182371],
$       [3871252863461903215, 2691320147774415098], [-658374193913418603, 4696123632805044094],
$       [-2068550129154426327, 5176380139395406100], [-8292588293276399563, -491628452146271577],
$       [438886987536528525, -1644005358374104318], [-684532856219060157, 2868560590456719067],
$       [69554286160794533, 7275022194721155047], [-3518473318721310589, 1336519410675261055],
$       [-4659537278145232167, -9082256087193768469], [-316118536602943058, -5674043762027123701],
$       [-8907316213811152604, 4459632089028710246], [-3686827354636938431, 6054792220766486032],
$       [-8876834487548519423, 4984770536108909912], [-188720735876632648, 202447375586823476],
$       [259970321110278180, 2325665127909125666], [7525746048611889822, -142678140403205828],
$       [-9099346318966504938, 8704020409959767156], [4098944662355642499, 4459632089028710246],
$       [-7498035890670934359, -6634048422810996684], [-5418174034955301301, 5564747288305124698],
$       [-2213506621779871567, 8266873997826160398], [-3659467821481400806, -8219606497499654265],
$       [-6943541741418273942, 1803653415159605298], [6678168747800030962, -6325223986978187882],
$       [-1407659838429644918, -2034076983400711805], [8537695275457997251, -2461116732068771262],
$       [-7820330777414514736, 7765558497409305805], [-4098261888423785194, 4659466063738203321],
$       [5147720482329847828, 7504235461477619600], [-5297949307745046801, -9136571790135809138],
$       [2177048409907036553, 8525502292768509005], [-4321696979445949247, 3997558606762432822],
$       [-1053800015058449886, -575360144938076886], [6467506891294213387, 8938008408833941746],
$       [1371928011475709783, -3479004357275689990], [7003129243922339222, 2906223553992159634],
$       [2026801416478354113, 7429976165742346768], [-4970164241750306588, -6630115979848802952],
$       [7244263225881107855, 4138819398500679276], [-3562612926252458801, 5491721703656319105],
$       [-3210542612587540907, -8383193819250514385], [9030686395788505522, 6459622175779915242],
$       [2955829121864027762, 3714322151457986197], [4360795952945203647, -8905756600407758136],
$       [-6299234719862638668, 2595790855422929096], [8135683431501796172, 8645101700450525841],
$       [7978266372068440782, 2559105632570315258], [661413179136007842, 8831341033720830540],
$       [5051511055171260817, 3669284957165748515], [8363859759012658973, -4443846600825516838],
$       [1515611945825418847, 5943282903042098275], [6880555901910961798, 85849089114005333],
$       [3981068488374749414, 3897445867337857013], [6024643537744769821, 5492756499642873037],
$       [-4076953402887838429, 3501935797137154963], [-6529294951901496067, -7945373814176992060],
$       [-7425631231213912123, -3560029612757236837], [-2726553591147545912, 9197778995912379265],
$       [-7054977139467973086, 7694520093783479643], [8993613185948270769, 6246029443405160411]]}
