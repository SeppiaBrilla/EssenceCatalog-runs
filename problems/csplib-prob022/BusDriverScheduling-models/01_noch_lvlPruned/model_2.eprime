language ESSENCE' 1.0

given Tasks_EnumSize: int
given fin1: int
given fin2: int
given shifts_ExplicitR6_ExplicitVarSizeWithDummy:
        matrix indexed by [int(1..fin1), int(1..fin2)] of int(1..Tasks_EnumSize + 1)
find sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Marker: int(0..Tasks_EnumSize)
find sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Values_ExplicitVarSizeWithDummy:
        matrix indexed by [int(1..Tasks_EnumSize), int(1..Tasks_EnumSize)] of int(1..Tasks_EnumSize + 1)
branching on
    [sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Marker,
     sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Values_ExplicitVarSizeWithDummy]
minimising sum([toInt(q37 <= sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Marker) | q37 : int(1..Tasks_EnumSize)])
such that
    and([q19 <= sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Marker ->
         or([and([or([sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Values_ExplicitVarSizeWithDummy[q19, q25] !=
                      Tasks_EnumSize + 1
                      /\
                      sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Values_ExplicitVarSizeWithDummy[q19, q25] =
                      shifts_ExplicitR6_ExplicitVarSizeWithDummy[q21, q23]
                          | q25 : int(1..Tasks_EnumSize)])
                      | q23 : int(1..fin2), shifts_ExplicitR6_ExplicitVarSizeWithDummy[q21, q23] != Tasks_EnumSize + 1])
             /\
             and([sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Values_ExplicitVarSizeWithDummy[q19, q27] !=
                  Tasks_EnumSize + 1
                  ->
                  or([shifts_ExplicitR6_ExplicitVarSizeWithDummy[q21, q29] =
                      sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Values_ExplicitVarSizeWithDummy[q19, q27]
                          | q29 : int(1..fin2),
                            shifts_ExplicitR6_ExplicitVarSizeWithDummy[q21, q29] != Tasks_EnumSize + 1])
                      | q27 : int(1..Tasks_EnumSize)])
                 | q21 : int(1..fin1)])
             | q19 : int(1..Tasks_EnumSize)]),
    alldifferent_except([toInt(q30 <= sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Marker /\
                               sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Values_ExplicitVarSizeWithDummy
                                   [q30, q31]
                               != Tasks_EnumSize + 1)
                         *
                         catchUndef(sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Values_ExplicitVarSizeWithDummy
                                        [q30, q31],
                                    0)
                             | q30 : int(1..Tasks_EnumSize), q31 : int(1..Tasks_EnumSize)],
                        0),
    and([q32 <= sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Marker ->
         sum([toInt(sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Values_ExplicitVarSizeWithDummy[q32, q34] !=
                    Tasks_EnumSize + 1)
                  | q34 : int(1..Tasks_EnumSize)])
         >= 1
             | q32 : int(1..Tasks_EnumSize)]),
    and([q4 + 1 <= sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Marker ->
         [sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Values_ExplicitVarSizeWithDummy[q4, q12]
              | q12 : int(1..Tasks_EnumSize)]
         <lex
         [sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Values_ExplicitVarSizeWithDummy[q4 + 1, q13]
              | q13 : int(1..Tasks_EnumSize)]
             | q4 : int(1..Tasks_EnumSize - 1)]),
    and([q5 > sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Marker ->
         and([sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Values_ExplicitVarSizeWithDummy[q5, q14] = 1
                  | q14 : int(1..Tasks_EnumSize)])
             | q5 : int(1..Tasks_EnumSize)]),
    sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Marker <= Tasks_EnumSize,
    and([q6 <= sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Marker ->
         and([sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Values_ExplicitVarSizeWithDummy[q6, q7] <
              sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Values_ExplicitVarSizeWithDummy[q6, q7 + 1]
              \/
              sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Values_ExplicitVarSizeWithDummy[q6, q7] =
              Tasks_EnumSize + 1
                  | q7 : int(1..Tasks_EnumSize - 1)])
             | q6 : int(1..Tasks_EnumSize)]),
    and([q6 <= sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Marker ->
         and([sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Values_ExplicitVarSizeWithDummy[q6, q8] =
              Tasks_EnumSize + 1
              ->
              sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Values_ExplicitVarSizeWithDummy[q6, q8 + 1] =
              Tasks_EnumSize + 1
                  | q8 : int(1..Tasks_EnumSize - 1)])
             | q6 : int(1..Tasks_EnumSize)]),
    and([q6 <= sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Marker ->
         sum([toInt(sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Values_ExplicitVarSizeWithDummy[q6, q9] !=
                    Tasks_EnumSize + 1)
                  | q9 : int(1..Tasks_EnumSize)])
         <= Tasks_EnumSize
             | q6 : int(1..Tasks_EnumSize)]),
    Tasks_EnumSize =
    sum([toInt(q15 <= sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Marker) *
         catchUndef(sum([toInt(sched_PartitionAsSet_ExplicitVarSizeWithMarkerR6_Values_ExplicitVarSizeWithDummy
                                   [q15, q17]
                               != Tasks_EnumSize + 1)
                             | q17 : int(1..Tasks_EnumSize)]),
                    0)
             | q15 : int(1..Tasks_EnumSize)])

$ Conjure's
$ {"finds": [{"Name": "sched"}], "givens": [{"Name": "shifts"}], "enumGivens": [{"Name": "Tasks"}], "enumLettings": [],
$  "lettings":
$      [[{"Name": "Tasks"},
$        {"Domain":
$             {"DomainInt":
$                  [{"TagEnum": "Tasks"},
$                   [{"RangeBounded":
$                         [{"Constant": {"ConstantInt": [{"TagEnum": "Tasks"}, 1]}},
$                          {"Reference":
$                               [{"Name": "Tasks_EnumSize"},
$                                {"DeclNoRepr":
$                                     ["Given", {"Name": "Tasks_EnumSize"}, {"DomainInt": [{"TagEnum": "Tasks"}, []]},
$                                      {"NoRegion": []}]}]}]}]]}}]],
$  "unnameds": [], "strategyQ": {"PickFirst": []}, "strategyA": {"PickAll": []},
$  "trailCompact":
$      [[1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 2, 4], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1]],
$  "trailVerbose": [], "trailRewrites": [], "nameGenState": [["fin", 3], ["q", 38]], "nbExtraGivens": 2,
$  "representations":
$      [[{"MachineName": ["fin", 1, []]}, {"DomainInt": [{"TagInt": []}, []]}],
$       [{"MachineName": ["fin", 2, []]}, {"DomainInt": [{"TagInt": []}, []]}],
$       [{"Name": "Tasks_EnumSize"}, {"DomainInt": [{"TagEnum": "Tasks"}, []]}],
$       [{"Name": "sched"},
$        {"DomainPartition":
$             [{"Partition_AsSet": [{"Set_ExplicitVarSizeWithMarker": []}, {"Set_ExplicitVarSizeWithDummy": []}]},
$              {"isRegular": false,
$               "partsNum":
$                   {"SizeAttr_MaxSize":
$                        {"Reference":
$                             [{"Name": "Tasks_EnumSize"},
$                              {"DeclHasRepr":
$                                   ["Given", {"Name": "Tasks_EnumSize"}, {"DomainInt": [{"TagEnum": "Tasks"}, []]}]}]}},
$               "partsSize":
$                   {"SizeAttr_MaxSize":
$                        {"Reference":
$                             [{"Name": "Tasks_EnumSize"},
$                              {"DeclHasRepr":
$                                   ["Given", {"Name": "Tasks_EnumSize"}, {"DomainInt": [{"TagEnum": "Tasks"}, []]}]}]}}},
$              {"DomainInt":
$                   [{"TagEnum": "Tasks"},
$                    [{"RangeBounded":
$                          [{"Constant": {"ConstantInt": [{"TagEnum": "Tasks"}, 1]}},
$                           {"Reference":
$                                [{"Name": "Tasks_EnumSize"},
$                                 {"DeclHasRepr":
$                                      ["Given", {"Name": "Tasks_EnumSize"},
$                                       {"DomainInt": [{"TagEnum": "Tasks"}, []]}]}]}]}]]}]}],
$       [{"Name": "shifts"},
$        {"DomainSet":
$             [{"Set_Explicit": []},
$              {"SizeAttr_Size":
$                   {"Reference":
$                        [{"MachineName": ["fin", 1, []]},
$                         {"DeclHasRepr":
$                              ["Given", {"MachineName": ["fin", 1, []]}, {"DomainInt": [{"TagInt": []}, []]}]}]}},
$              {"DomainSet":
$                   [{"Set_ExplicitVarSizeWithDummy": []},
$                    {"SizeAttr_MaxSize":
$                         {"Reference":
$                              [{"MachineName": ["fin", 2, []]},
$                               {"DeclHasRepr":
$                                    ["Given", {"MachineName": ["fin", 2, []]}, {"DomainInt": [{"TagInt": []}, []]}]}]}},
$                    {"DomainInt":
$                         [{"TagEnum": "Tasks"},
$                          [{"RangeBounded":
$                                [{"Constant": {"ConstantInt": [{"TagEnum": "Tasks"}, 1]}},
$                                 {"Reference":
$                                      [{"Name": "Tasks_EnumSize"},
$                                       {"DeclHasRepr":
$                                            ["Given", {"Name": "Tasks_EnumSize"},
$                                             {"DomainInt": [{"TagEnum": "Tasks"}, []]}]}]}]}]]}]}]}]],
$  "representationsTree":
$      [[{"Name": "Tasks_EnumSize"}, [{"rootLabel": null, "subForest": []}]],
$       [{"MachineName": ["fin", 1, []]}, [{"rootLabel": null, "subForest": []}]],
$       [{"MachineName": ["fin", 2, []]}, [{"rootLabel": null, "subForest": []}]],
$       [{"Name": "sched"},
$        [{"rootLabel":
$              {"Partition_AsSet": [{"Set_ExplicitVarSizeWithMarker": []}, {"Set_ExplicitVarSizeWithDummy": []}]},
$          "subForest": [{"rootLabel": null, "subForest": []}]}]],
$       [{"Name": "shifts"},
$        [{"rootLabel": {"Set_Explicit": []},
$          "subForest":
$              [{"rootLabel": {"Set_ExplicitVarSizeWithDummy": []},
$                "subForest": [{"rootLabel": null, "subForest": []}]}]}]]],
$  "originalDomains":
$      [[{"Name": "shifts"},
$        {"DomainSet":
$             [[], {"SizeAttr_None": []},
$              {"DomainSet": [[], {"SizeAttr_None": []}, {"DomainEnum": [{"Name": "Tasks"}, null, null]}]}]}],
$       [{"Name": "sched"},
$        {"DomainPartition":
$             [[],
$              {"isRegular": false,
$               "partsNum":
$                   {"SizeAttr_MaxSize":
$                        {"Reference":
$                             [{"Name": "Tasks_EnumSize"},
$                              {"DeclHasRepr":
$                                   ["Given", {"Name": "Tasks_EnumSize"}, {"DomainInt": [{"TagInt": []}, []]}]}]}},
$               "partsSize":
$                   {"SizeAttr_MaxSize":
$                        {"Reference":
$                             [{"Name": "Tasks_EnumSize"},
$                              {"DeclHasRepr":
$                                   ["Given", {"Name": "Tasks_EnumSize"}, {"DomainInt": [{"TagInt": []}, []]}]}]}}},
$              {"DomainEnum": [{"Name": "Tasks"}, null, null]}]}]],
$  "trailGeneralised":
$      [[3730373539309326918, 5376326650004559892], [-8669097813492147108, 1255488532644803572],
$       [-6667714764224673419, 1594141957183743435], [-8158183680583807304, 8335472685143541497],
$       [2980055392493833230, -964234765568832005], [3345700876797587256, -8112450597396923468],
$       [-625671096756644050, 8812567854492183038], [-4433154268942957390, -2265835473654782763],
$       [4895161880478578836, 3019263568094935559], [1197444238062903268, -2425042380435258019],
$       [-8991835038446672188, 9172877008341849497], [-3426640790072209575, -3719171569023950787],
$       [-8402316896404293208, 4597035869899593387], [6180897408658103414, -8112450597396923468],
$       [1251254005931116721, -10682532025086888], [5632847391250896283, 4459632089028710246],
$       [784410839423458815, 5282903378846725829], [-6831719170832041926, -1556570839616648817],
$       [-2428220502096921387, -1824296085926796461], [-8627203077331972191, 6902133732910452344],
$       [-4946669885115630967, -3939778981642346658], [1387555678784895373, 4459632089028710246],
$       [6179850352282558707, 6513264353331456225], [7737515017979066013, -7883224519492731320],
$       [965718120145960113, -4465623744916789287], [-561562906455020707, -3308454186364840393],
$       [-5360912553933478977, 45354724204658057], [-22937511187589799, 7886519912292696879],
$       [580213545211121868, 225722782627606991], [-4898965495065611466, 4459632089028710246],
$       [6912147439237957068, 4459632089028710246], [-6985603632181587449, -8808365610178819826],
$       [6466481503852597407, 4657545803439388610], [3551025661637938752, 1588560998182548819],
$       [3332735857402211690, -6380671775189976904], [-8454281891472831172, -3110880192539211303],
$       [4507764444405012645, 4179072996787172004], [-3651114504761721393, 4459632089028710246],
$       [-8976529170455715437, 2166218220485564892], [-3815095333711711289, 4459632089028710246],
$       [2362396518129108945, -7927490203441358558], [3219560065450923487, 552801199401606615],
$       [-3918604210008259637, 976118455221885039], [3442649938380984586, -6878302340602425996],
$       [-5743206669713479046, -6587767965745373022], [3163248136618140009, -8185603075506234114],
$       [-6297570888517632582, 4169298895447770123], [-6768962956526081576, -8157684675544462965],
$       [-8616143601322387086, 8912539396923997911], [-6081010792456616377, 6055971432898620913],
$       [-2694720854659109741, -5680525526772242908], [5278772648747129453, 1506689063409176620],
$       [-7404097514593637831, 596712271702221401], [-7292114065196951281, 7118333662110849572],
$       [8561200379941757002, -5976814519655910741], [-6574722878407280204, -8112450597396923468],
$       [5975490642371133803, 215355851072667208], [3597363008328807183, 4459632089028710246],
$       [1746457842188632343, -5081470723369803797], [-7051794307485834936, 3446367633853315495],
$       [5755009206957164926, 6653237323891565776], [2080921604485886407, 219473880160919320],
$       [497234535714460417, 5765970659625164243], [-5902192010584230910, 9112708223353992303],
$       [-4622514882535868207, -8377166667153850682], [-5701781785528165072, 2139046696875308676],
$       [3326299577985774195, 1663803612194885105], [7778212840479589674, 1145895824293090317],
$       [-4593551463895664644, 491286065594434658], [-6421041204047362012, -7931841504185647149],
$       [-1688230620936039497, 4661533253511935104], [-8710004826843403635, -1893499702289645989],
$       [-296336944253368635, -3845350389343315796], [-1595021605201137803, -6799971209221539013],
$       [-8850283731902764074, 3513691351203079987], [7386911688463466645, -5277555456940598806],
$       [8903793740222217479, 5029897756441351088], [2999906546187713647, 2694830917777786625],
$       [-4041169806465329752, -7601417422465855727], [6369492559927990339, 7482834606036836855],
$       [-5579006913124437513, 8029592436471403559], [1187819595840368390, -7945373814176992060],
$       [-7425631231213912123, 3084173838644979206], [-2726553591147545912, 9197778995912379265],
$       [-7054977139467973086, 7694520093783479643], [8993613185948270769, 6246029443405160411]]}
