language ESSENCE' 1.0

given n: int(1..)
find black_ExplicitVarSizeWithFlags_Flags: matrix indexed by [int(1..n * n)] of bool
find black_ExplicitVarSizeWithFlags_Values_1: matrix indexed by [int(1..n * n)] of int(1..n)
find black_ExplicitVarSizeWithFlags_Values_2: matrix indexed by [int(1..n * n)] of int(1..n)
find white_ExplicitVarSizeWithFlags_Flags: matrix indexed by [int(1..n * n)] of bool
find white_ExplicitVarSizeWithFlags_Values_1: matrix indexed by [int(1..n * n)] of int(1..n)
find white_ExplicitVarSizeWithFlags_Values_2: matrix indexed by [int(1..n * n)] of int(1..n)
branching on
    [black_ExplicitVarSizeWithFlags_Flags, black_ExplicitVarSizeWithFlags_Values_1,
     black_ExplicitVarSizeWithFlags_Values_2, white_ExplicitVarSizeWithFlags_Flags,
     white_ExplicitVarSizeWithFlags_Values_1, white_ExplicitVarSizeWithFlags_Values_2]
maximising
    sum([toInt(black_ExplicitVarSizeWithFlags_Flags[q12]) | q12 : int(1..n * n)]) +
    sum([toInt(white_ExplicitVarSizeWithFlags_Flags[q14]) | q14 : int(1..n * n)])
such that
    sum([toInt(black_ExplicitVarSizeWithFlags_Flags[q16]) | q16 : int(1..n * n)]) =
    sum([toInt(white_ExplicitVarSizeWithFlags_Flags[q18]) | q18 : int(1..n * n)]),
    and([black_ExplicitVarSizeWithFlags_Flags[q20] ->
         and([white_ExplicitVarSizeWithFlags_Flags[q22] ->
              black_ExplicitVarSizeWithFlags_Values_1[q20] != white_ExplicitVarSizeWithFlags_Values_1[q22] /\
              black_ExplicitVarSizeWithFlags_Values_2[q20] != white_ExplicitVarSizeWithFlags_Values_2[q22]
              /\
              |white_ExplicitVarSizeWithFlags_Values_1[q22] - black_ExplicitVarSizeWithFlags_Values_1[q20]| !=
              |white_ExplicitVarSizeWithFlags_Values_2[q22] - black_ExplicitVarSizeWithFlags_Values_2[q20]|
                  | q22 : int(1..n * n)])
             | q20 : int(1..n * n)]),
    and([black_ExplicitVarSizeWithFlags_Flags[q1 + 1] ->
         flatten([[black_ExplicitVarSizeWithFlags_Values_1[q1]; int(1)],
                  [black_ExplicitVarSizeWithFlags_Values_2[q1]; int(1)];
                      int(1..2)])
         <lex
         flatten([[black_ExplicitVarSizeWithFlags_Values_1[q1 + 1]; int(1)],
                  [black_ExplicitVarSizeWithFlags_Values_2[q1 + 1]; int(1)];
                      int(1..2)])
             | q1 : int(1..n * n - 1)]),
    and([black_ExplicitVarSizeWithFlags_Flags[q2] = false ->
         black_ExplicitVarSizeWithFlags_Values_1[q2] = 1 /\ black_ExplicitVarSizeWithFlags_Values_2[q2] = 1
             | q2 : int(1..n * n)]),
    and([black_ExplicitVarSizeWithFlags_Flags[q3 + 1] -> black_ExplicitVarSizeWithFlags_Flags[q3]
             | q3 : int(1..n * n - 1)]),
    and([white_ExplicitVarSizeWithFlags_Flags[q6 + 1] ->
         flatten([[white_ExplicitVarSizeWithFlags_Values_1[q6]; int(1)],
                  [white_ExplicitVarSizeWithFlags_Values_2[q6]; int(1)];
                      int(1..2)])
         <lex
         flatten([[white_ExplicitVarSizeWithFlags_Values_1[q6 + 1]; int(1)],
                  [white_ExplicitVarSizeWithFlags_Values_2[q6 + 1]; int(1)];
                      int(1..2)])
             | q6 : int(1..n * n - 1)]),
    and([white_ExplicitVarSizeWithFlags_Flags[q7] = false ->
         white_ExplicitVarSizeWithFlags_Values_1[q7] = 1 /\ white_ExplicitVarSizeWithFlags_Values_2[q7] = 1
             | q7 : int(1..n * n)]),
    and([white_ExplicitVarSizeWithFlags_Flags[q8 + 1] -> white_ExplicitVarSizeWithFlags_Flags[q8]
             | q8 : int(1..n * n - 1)])

$ Conjure's
$ {"finds": [{"Name": "black"}, {"Name": "white"}], "givens": [{"Name": "n"}], "enumGivens": [], "enumLettings": [],
$  "lettings":
$      [[{"Name": "Index"},
$        {"Domain":
$             {"DomainInt":
$                  [{"TagInt": []},
$                   [{"RangeBounded":
$                         [{"Constant": {"ConstantInt": [{"TagInt": []}, 1]}},
$                          {"Reference":
$                               [{"Name": "n"},
$                                {"DeclNoRepr":
$                                     ["Given", {"Name": "n"},
$                                      {"DomainInt":
$                                           [{"TagInt": []},
$                                            [{"RangeLowerBounded":
$                                                  {"Constant": {"ConstantInt": [{"TagInt": []}, 1]}}}]]},
$                                      {"NoRegion": []}]}]}]}]]}}],
$       [{"Name": "Square"},
$        {"Domain":
$             {"DomainTuple":
$                  [{"DomainInt":
$                        [{"TagInt": []},
$                         [{"RangeBounded":
$                               [{"Constant": {"ConstantInt": [{"TagInt": []}, 1]}},
$                                {"Reference":
$                                     [{"Name": "n"},
$                                      {"DeclNoRepr":
$                                           ["Given", {"Name": "n"},
$                                            {"DomainInt":
$                                                 [{"TagInt": []},
$                                                  [{"RangeLowerBounded":
$                                                        {"Constant": {"ConstantInt": [{"TagInt": []}, 1]}}}]]},
$                                            {"NoRegion": []}]}]}]}]]},
$                   {"DomainInt":
$                        [{"TagInt": []},
$                         [{"RangeBounded":
$                               [{"Constant": {"ConstantInt": [{"TagInt": []}, 1]}},
$                                {"Reference":
$                                     [{"Name": "n"},
$                                      {"DeclNoRepr":
$                                           ["Given", {"Name": "n"},
$                                            {"DomainInt":
$                                                 [{"TagInt": []},
$                                                  [{"RangeLowerBounded":
$                                                        {"Constant": {"ConstantInt": [{"TagInt": []}, 1]}}}]]},
$                                            {"NoRegion": []}]}]}]}]]}]}}]],
$  "unnameds": [], "strategyQ": {"PickFirst": []}, "strategyA": {"PickAll": []},
$  "trailCompact":
$      [[1, 1, 1], [1, 2, 2], [1, 2, 2], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1],
$       [1, 1, 1]],
$  "trailVerbose": [], "trailRewrites": [], "nameGenState": [["q", 23]], "nbExtraGivens": 0,
$  "representations":
$      [[{"Name": "n"},
$        {"DomainInt": [{"TagInt": []}, [{"RangeLowerBounded": {"Constant": {"ConstantInt": [{"TagInt": []}, 1]}}}]]}],
$       [{"Name": "black"},
$        {"DomainSet":
$             [{"Set_ExplicitVarSizeWithFlags": []}, {"SizeAttr_None": []},
$              {"DomainTuple":
$                   [{"DomainInt":
$                         [{"TagInt": []},
$                          [{"RangeBounded":
$                                [{"Constant": {"ConstantInt": [{"TagInt": []}, 1]}},
$                                 {"Reference":
$                                      [{"Name": "n"},
$                                       {"DeclHasRepr":
$                                            ["Given", {"Name": "n"},
$                                             {"DomainInt":
$                                                  [{"TagInt": []},
$                                                   [{"RangeLowerBounded":
$                                                         {"Constant": {"ConstantInt": [{"TagInt": []}, 1]}}}]]}]}]}]}]]},
$                    {"DomainInt":
$                         [{"TagInt": []},
$                          [{"RangeBounded":
$                                [{"Constant": {"ConstantInt": [{"TagInt": []}, 1]}},
$                                 {"Reference":
$                                      [{"Name": "n"},
$                                       {"DeclHasRepr":
$                                            ["Given", {"Name": "n"},
$                                             {"DomainInt":
$                                                  [{"TagInt": []},
$                                                   [{"RangeLowerBounded":
$                                                         {"Constant":
$                                                              {"ConstantInt": [{"TagInt": []}, 1]}}}]]}]}]}]}]]}]}]}],
$       [{"Name": "white"},
$        {"DomainSet":
$             [{"Set_ExplicitVarSizeWithFlags": []}, {"SizeAttr_None": []},
$              {"DomainTuple":
$                   [{"DomainInt":
$                         [{"TagInt": []},
$                          [{"RangeBounded":
$                                [{"Constant": {"ConstantInt": [{"TagInt": []}, 1]}},
$                                 {"Reference":
$                                      [{"Name": "n"},
$                                       {"DeclHasRepr":
$                                            ["Given", {"Name": "n"},
$                                             {"DomainInt":
$                                                  [{"TagInt": []},
$                                                   [{"RangeLowerBounded":
$                                                         {"Constant": {"ConstantInt": [{"TagInt": []}, 1]}}}]]}]}]}]}]]},
$                    {"DomainInt":
$                         [{"TagInt": []},
$                          [{"RangeBounded":
$                                [{"Constant": {"ConstantInt": [{"TagInt": []}, 1]}},
$                                 {"Reference":
$                                      [{"Name": "n"},
$                                       {"DeclHasRepr":
$                                            ["Given", {"Name": "n"},
$                                             {"DomainInt":
$                                                  [{"TagInt": []},
$                                                   [{"RangeLowerBounded":
$                                                         {"Constant":
$                                                              {"ConstantInt": [{"TagInt": []}, 1]}}}]]}]}]}]}]]}]}]}]],
$  "representationsTree":
$      [[{"Name": "black"},
$        [{"rootLabel": {"Set_ExplicitVarSizeWithFlags": []},
$          "subForest":
$              [{"rootLabel": null,
$                "subForest": [{"rootLabel": null, "subForest": []}, {"rootLabel": null, "subForest": []}]}]}]],
$       [{"Name": "n"}, [{"rootLabel": null, "subForest": []}]],
$       [{"Name": "white"},
$        [{"rootLabel": {"Set_ExplicitVarSizeWithFlags": []},
$          "subForest":
$              [{"rootLabel": null,
$                "subForest": [{"rootLabel": null, "subForest": []}, {"rootLabel": null, "subForest": []}]}]}]]],
$  "originalDomains":
$      [[{"Name": "n"},
$        {"DomainInt": [{"TagInt": []}, [{"RangeLowerBounded": {"Constant": {"ConstantInt": [{"TagInt": []}, 1]}}}]]}],
$       [{"Name": "black"},
$        {"DomainSet":
$             [[], {"SizeAttr_None": []},
$              {"DomainTuple":
$                   [{"DomainInt":
$                         [{"TagInt": []},
$                          [{"RangeBounded":
$                                [{"Constant": {"ConstantInt": [{"TagInt": []}, 1]}},
$                                 {"Reference": [{"Name": "n"}, null]}]}]]},
$                    {"DomainInt":
$                         [{"TagInt": []},
$                          [{"RangeBounded":
$                                [{"Constant": {"ConstantInt": [{"TagInt": []}, 1]}},
$                                 {"Reference": [{"Name": "n"}, null]}]}]]}]}]}],
$       [{"Name": "white"},
$        {"DomainSet":
$             [[], {"SizeAttr_None": []},
$              {"DomainTuple":
$                   [{"DomainInt":
$                         [{"TagInt": []},
$                          [{"RangeBounded":
$                                [{"Constant": {"ConstantInt": [{"TagInt": []}, 1]}},
$                                 {"Reference": [{"Name": "n"}, null]}]}]]},
$                    {"DomainInt":
$                         [{"TagInt": []},
$                          [{"RangeBounded":
$                                [{"Constant": {"ConstantInt": [{"TagInt": []}, 1]}},
$                                 {"Reference": [{"Name": "n"}, null]}]}]]}]}]}]],
$  "trailGeneralised":
$      [[3788571356254787923, 8310875948267672207], [3699497330268157805, 3911978125037629663],
$       [-66459095584591751, -5700348617298939423], [-3109022888451174764, -5654744967410058728],
$       [-5194092457652160663, -5700348617298939423], [-880055393422400417, -5654744967410058728],
$       [7937302029236352981, -5450979904847771557], [4323821309764209119, -3766568347209283369],
$       [-8711920392071498111, 2460151642009274417], [8638508725379357044, 6153559702542057313],
$       [7042841569847398105, -2569905549758839212], [-4411080250832138221, 6153559702542057313],
$       [843071817660688368, -2569905549758839212], [-7647280556733495729, 8802970994375875567],
$       [-974867617153455927, -1310569023355637217], [7709808599445508885, -6492414949155698647],
$       [2456628111282858033, 7853561007027043014], [882957193485459649, 1603198430594912182],
$       [-3820280528140634288, 3770499587763758091], [-5696989644918529242, -8112450597396923468],
$       [-4389766709729373413, -6645173167595495116], [9604657337258283, 2862911720668077167],
$       [-1377475026330644923, 8269754237899124215], [2452221419715831891, -3517158742176807221],
$       [3894501671108064625, -4751998155758984549], [-5151894525998004943, -8112450597396923468],
$       [-7602015079306381888, -3996052465138093564], [-5803778359702676030, -2299119784755296725],
$       [-6144839667058828388, 1888866531966210819], [-2604705009945460670, 883617370702013717],
$       [5573668655943089949, 3352817421133906283], [1980323588959508699, -8112450597396923468],
$       [-9085117899436036411, 8781269440333680620], [1411365636507000597, -5267880109716313985],
$       [5105848111191080887, -4306126653454344025], [4007597058589290511, -8437703391759047513],
$       [-4705975336455566749, 4471813195523184411], [5941156328918166027, -8112450597396923468],
$       [-6880228262629671251, -3264590240319422404], [1486947571907897571, 885882944888493491],
$       [2300579787623220705, -2307320589885843093], [6799536471740331163, -5456800088240839935],
$       [4193362247814823843, -8563308443459945842], [-8379598942434297007, -4904348884243174639],
$       [7030854105938623858, -7601339039855423899], [5467325807558320180, -5108806316830393239],
$       [1895599909035302881, -8378714736352722946], [5777311540292165035, 6669017110497405813],
$       [-785906796206205767, -3921303674740475992], [-5256380001190509415, 7979892775409910317],
$       [-5345224762659699969, -3126258743491730244], [1733405191319333685, 1166811474854979829],
$       [721821024689097924, 2988554115201677153], [-7237464879682944206, 4600888986831224067],
$       [-3030368251102577153, -4186969057063984334], [-3179005728662734657, 4443845942866395845],
$       [1197798523909874479, 6715981933836261912], [-1360306143228818353, -7766103574887030167],
$       [4111068052347932474, -1868028076907613896], [-6499339351143805630, 8425623426300975496],
$       [8624308888451280299, 5599322668969595309]]}
